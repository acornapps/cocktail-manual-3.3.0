---
title: "サービス管理レイヤー"
---


---

一般的に、一つのアプリケーションやサービスは、多数のコンテナで構成されている。特にKubernetesのようなオーケストレーションエンジンの場合、コンテナ以外にもサービスポート、コントローラ、ボリュームなどの追加オブジェクトを必要とする。したがって、コンテナベースのアプリケーションおよびサービスを管理するためには、コンテナと関連オブジェクトをパッケージ化して管理する抽象化の単位が必要である。サービス管理レイヤーは、これを担うレイヤーである。

カクテルクラウドのサービス管理は、以下のような階層構造を有する。

* Service : 最上位階層としてサービスに必要なクラスターリソース、イメージレジストリ、イメージビルドを割り当て管理するグループ。開発、運用者の役割に応じて権限を付与し、独立させて管理を行うことができる。カクテルクラウドでは、必要に応じて多数のサービスを作成し、チームやサービスごとに割り当てて管理することができる。

* Service Map : アプリケーションの構成と管理を行う単位で、一つのワークロード（Workload）に対応している。例えば、一つのサービスを開発系、検証系、運用系に該当するアプリケーションマップで構成することができるほか、データ管理、分析システムなどの役割に基づいて、サービスマップを構成することもできる。サービスマップは、論理的にワークロードのための多数のコンテナの構成を管理する単位といえる。前述したサービスは、複数のサービスマップで構成されている。

* Workload : コンテナと関連オーケストレーションオブジェクトをパッケージ化する単位である。サービスマップは、複数のワークロードで構成されている。例えば、Webサーバー、DBサーバーなどのコンポーネントに基づいてワークロードを構成することもでき、小規模のマイクロサービスもワークロードとして構成することができる。 ワークロードの詳細は、下記の通りである。

下の図は、サービス管理レイヤーの構成を図式化したものである。

![]({{< param imageRootDir >}}/assets/cocktailcloud-architecture-3.png)

**Workload**

サービス管理レイヤーにおいて、最も重要な役割を担っているのがワークロードだ。前述したとおり、ワークロードは、コンテナと関連オーケストレーションオブジェクトをパッケージ化する単位である。ワークロードは、パッケージ化されたオブジェクトの作成、更新などライフサイクルを管理するとともに、状態とリソースをパッケージ単位で監視し、管理する。

これを図式化したのが下の図である。

![]({{< param imageRootDir >}}/assets/cocktailcloud-architecture-4.png)

ワークロードが提供する管理機能には、次のようなものがある。

* ワークロードの作成、修正（更新）、停止、再起動、削除、オートスケール

* ローリングアップデート

* サービスポート管理

* ボリューム管理

* 監視

* インスペクティング : オーケストレーションオブジェクトの状態およびデプロイ情報の照会

* ウェブターミナル、ログの照会：コンテナへのシェル接続。コンテナのログ照会
